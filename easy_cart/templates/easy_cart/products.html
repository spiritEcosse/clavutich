{% load thumbnail %}

<div class="col-xs-12" ng-cloak ng-controller="Products" ng-init="action_remove='{% url "easy_cart:remove" %}'"  >
    <div class="row" ng-init="action_cart='{% url "easy_cart:show" %}' " >
        <div class="col-xs-12" ng-init="action_update_quantity_product='{% url "easy_cart:update_quantity_product" %}'">
            {% verbatim alerts %}
                <div id="alerts">
                    <alert ng-repeat="alert in alerts" type="{{alert.type}}" close="closeAlert($index)">{{alert.msg}}</alert>
                </div>
            {% endverbatim alerts %}
        </div>

        <div class="col-xs-12" id="cart">
            {% if cart.count %}
                <div class="row">
                    <div class="col-xs-12">
                        <div class='col-md-1 hidden-xs hidden-sm'>#</div>
                        <div class='col-xs-4 col-sm-4'><strong>Название</strong></div>
                        <div class='col-sm-3 hidden-xs'><strong>Картинка</strong></div>
                        <div class='col-xs-5 col-sm-3 col-md-2'><strong>Количество</strong></div>
                        <div class='col-xs-3 col-sm-2'><strong>Удалить</strong></div>
                    </div>
                </div>
                <hr>
                {% for item in cart %}
                    <div class="row" data-ng-model="products[{{ forloop.counter0 }}]">
                        <div class="col-xs-12">
                            <div class="col-md-1 hidden-xs hidden-sm" >{{ forloop.counter }}</div>
                            <div class="col-xs-4 col-sm-4"><a href="{{ item.product.get_absolute_url }}">{{ item.product.title|lower|capfirst }}</a></div>
                            <div class="col-sm-3 hidden-xs">
                                {% thumbnail item.product.image "100x100" as im %}
                                    <a id="main" href="{{ item.product.image.url }}" class="pull-left highslide"
                                       onclick="return hs.expand(this, { slideshowGroup: 1, thumbnailId: 'main' } )">
                                        <img src="{{ im.url }}" class="img-responsive img-rounded" alt="{{ item.product.title }}" title="{{ item.product.title }}">
                                    </a>
                                {% endthumbnail %}
                            </div>
                            <div class="col-xs-5 col-sm-3 col-md-2">
                                <div class="input-group">
                                    <input type="number" class="form-control" ng-model="products[{{ forloop.counter0 }}].quantity" aria-label="Количество" value="{{ item.quantity }}">
                                    <div class="input-group-btn">
                                        <button class="btn btn-default" ng-click="update_quantity(products['{{ forloop.counter0 }}'])">
                                            <span class="glyphicon glyphicon-refresh" aria-hidden="true"></span>
                                        </button>
                                    </div>
                                </div>
                            </div>
                            <div class="col-xs-3 col-sm-2">
                                <div class="input-group">
                                    <button class="btn btn-default" ng-click="remove('{{ forloop.counter0 }}', products['{{ forloop.counter0 }}'])">
                                        <span class="glyphicon glyphicon-remove" aria-hidden="true"></span>
                                    </button>
                                </div>
                            </div>
                        </div>
                    </div>
                    <hr>
                {% endfor %}
            {% else %}
                <div class="alert alert-info" role="alert">Ваша корзина пустая.</div>
            {% endif %}
        </div>
    </div>
</div>